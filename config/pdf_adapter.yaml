# PDF Adapter Configuration
# This file contains default settings for the PDF adapter.
# Actual file paths should be provided at runtime via API or code.

# Supported format: .pdf (Portable Document Format) ONLY
#
# Extraction capabilities:
# - Text extraction (layout-aware)
# - Table extraction (automatic detection)
# - Metadata extraction (author, title, dates, etc.)
# - Image detection and metadata
# - Multi-page document support
#
# Libraries used:
# - pdfplumber: Best-in-class table extraction, layout-aware text
# - pymupdf (PyMuPDF): High-performance, comprehensive metadata, OCR support

# Processing mode
use_cloud_processing: false

# Validation rules
validation:
  min_pages: 0  # Minimum number of pages required
  min_words: 0  # Minimum total word count across all pages
  allow_empty: false  # Whether documents with no extractable text are allowed
  require_tables: false  # Whether document must contain at least one table

# Transformation options
transformation:
  # Text extraction
  layout_mode: false  # Preserve document layout in text extraction (spaces, alignment)
  combine_pages: true  # Combine all pages into single "full_text" field
  page_separator: "\n\n"  # How to separate pages when combining (double newline)
  max_text_chars_per_page: null  # Optional int limit to trim text payload per page (null = no trim)
  
  # Feature extraction
  extract_metadata: true  # Extract document properties (author, title, dates, page count, etc.)
  extract_tables: false  # Extract tables as structured data (2D arrays per page)
  extract_images: false  # Extract image metadata (positions, dimensions - not raw image data)
  
  # Page range (optional) - process subset of pages
  # page_range: [0, 10]  # Process first 10 pages only (0-indexed). Omit to process all pages.

# OCR Settings (for scanned PDFs - requires additional setup)
# Requirements:
#   1. Install Tesseract on the host / container
#      - Debian / Ubuntu: sudo apt install tesseract-ocr tesseract-ocr-eng
#      - macOS (Homebrew): brew install tesseract
#   2. Optional language packs (e.g., tesseract-ocr-spa) for non-English scans
#   3. Ensure the `tesseract` binary is available on PATH for the runtime user
#   4. Consider enabling OCR only for scanned documents; it adds processing time
# Reference: https://pymupdf.readthedocs.io/en/latest/recipes-ocr.html
# Failure modes:
#   - If Tesseract is missing, enabling OCR will raise runtime errors
#   - OCR output increases payload size; large scans may require payload trimming
ocr:
  enabled: false  # Enable OCR for scanned documents
  language: "eng"  # Tesseract language code (eng, spa, fra, deu, etc.)
  # Additional languages can be specified as comma-separated: "eng,spa"

# Performance tuning
performance:
  max_pages: null  # Maximum pages to process (null = no limit)
  page_timeout: 30  # Maximum seconds per page before timeout (null = no limit)

# Table extraction settings (used when transformation.extract_tables = true)
# Tips:
#   - Choose strategies based on table structure:
#       * "lines" / "lines_strict" for ruled tables with clear borders
#       * "text" for whitespace-aligned tables without lines
#       * "explicit" when you provide custom ruling lines
#   - Increase snap_tolerance / join_tolerance for slightly skewed scans
#   - Lower tolerances to avoid merging nearby tables or captions
#   - Limit page_range in transformation config to table-heavy sections for faster runs
# Reference: https://github.com/jsvine/pdfplumber#table-extraction
table_settings:
  vertical_strategy: "lines"  # "lines", "lines_strict", "text", or "explicit"
  horizontal_strategy: "lines"  # "lines", "lines_strict", "text", or "explicit"
  snap_tolerance: 3  # Snap parallel lines within N points
  join_tolerance: 3  # Join line segments within N points
  edge_min_length: 3  # Discard edges shorter than N points
  min_words_vertical: 3  # Min words sharing alignment for text-based detection
  min_words_horizontal: 1  # Min words sharing alignment for text-based detection
